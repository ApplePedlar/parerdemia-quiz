/* 
 * パレデミア学園 寮生記憶ゲーム - レスポンシブスタイル
 * 
 * 異なる画面サイズに対応するためのスタイルを定義します。
 * 水無瀬 天さんのように柔軟に対応できる設計を心がけました。
 * 
 * スマートフォンでもタブレットでも、どの環境でも
 * パレデミア学園のタレントさんたちの魅力が
 * 伝わるよう工夫しています。飛渡 ココさんの
 * 自由さを技術面でも表現したいと思いました。
 */

/* モバイル対応のためのメディアクエリ */
@media (max-width: 768px) {
    .container {
        padding: 10px;
    }
    
    h1 {
        font-size: 24px;
        margin-bottom: 15px;
    }
    
    /* 設定パネルは常に閉じた状態で開始 */
    .accordion-content {
        max-height: 0;
        box-sizing: border-box;
        padding: 0 8px; /* 追加：常にサイドパディングを持たせる */
    }
    
    .accordion-open .accordion-content {
        padding: 8px; /* 追加：開いた時のパディングを設定 */
    }
    
    /* ゲーム設定ボタンのサイズを適切に調整 */
    #settings-toggle {
        width: 32px; /* 40pxから32pxに縮小 */
        height: 32px; /* 40pxから32pxに縮小 */
        padding: 0;
        font-size: 14px;
        position: relative;
        z-index: 100;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    
    /* 歯車アイコンのSVGが確実にクリック可能になるよう調整 */
    #settings-toggle svg {
        pointer-events: none;
        width: 16px; /* 20pxから16pxに縮小 */
        height: 16px; /* 20pxから16pxに縮小 */
    }
    
    /* 設定ステータスバーのモバイル調整 - 高さを小さく変更 */
    .settings-status-bar {
        padding: 4px 10px; /* 上下パディングを8pxから4pxに減らして高さを小さく */
        margin-bottom: 10px; /* 15pxから10pxに変更 */
        display: flex;
        flex-wrap: nowrap;
        gap: 3px; /* 5pxから3pxに変更 */
        justify-content: space-between;
        align-items: center;
        width: 100%;
        box-sizing: border-box;
        min-height: 35px; /* 最小高さを追加 */
    }
    
    .current-settings {
        gap: 4px; /* 6pxから4pxに減らす */
        font-size: 0.75rem; /* 0.8remから0.75remに縮小 */
        margin-right: 5px;
        display: flex;
        flex: 1 1 auto;
        flex-wrap: wrap;
        overflow: hidden;
        max-width: calc(100% - 35px); /* 歯車ボタンの新しいサイズに合わせる */
    }
    
    .setting-item {
        font-size: 0.75rem; /* 0.8remから0.75remに */
        white-space: nowrap;
        margin-right: 4px; /* 5pxから4pxに減らす */
        padding-right: 4px; /* 5pxから4pxに減らす */
        border-right: 1px solid #eee;
    }
    
    .setting-item:last-child {
        border-right: none;
    }
    
    /* 歯車ボタンを小さく */
    .settings-gear {
        width: 32px; /* 40pxから32pxに縮小 */
        height: 32px; /* 40pxから32pxに縮小 */
        min-width: 32px;
        max-width: 32px;
        padding: 0;
        margin-left: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        flex: 0 0 32px;
        align-self: center;
    }
    
    .settings-gear svg {
        width: 16px; /* 20pxから16pxに縮小 */
        height: 16px; /* 20pxから16pxに縮小 */
    }
    
    /* モーダルの調整 - 改善版 */
    .modal-content {
        margin: 5% auto;
        width: 92%;
        max-height: 90vh;
        overflow-y: auto;
    }
    
    .modal-header {
        padding: 10px 12px;
    }
    
    .close-button {
        font-size: 18px;
        width: 40px; /* モバイルでタッチしやすいように大きく */
        height: 40px;
        margin-left: 8px;
        flex: 0 0 40px; /* width と同じ値で固定 */
        margin-right: 0; /* ネガティブマージンを削除 */
    }
    
    .modal-body {
        padding: 15px;
    }
    
    /* ゲーム設定モーダル内のボタン調整 */
    .modal-body .controls button {
        padding: 10px 8px;
        font-size: 14px;
        flex: 1;
        margin: 3px;
        min-width: 80px; /* 0から80pxに変更してタッチしやすく */
    }
    
    /* ボタングループのレイアウト調整 */
    .button-group {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 8px;
        width: 100%;
    }
    
    .modal-body .controls h3 {
        font-size: 16px;
        margin: 5px 0;
    }
    
    .mode-selector, .options-selector, .difficulty-selector {
        margin-bottom: 15px;
    }
    
    /* コントロールを縦並びに */
    .controls {
        flex-direction: column;
        gap: 15px;
    }
    
    /* モバイル表示ではボタンの最大幅を調整 */
    button {
        padding: 10px;
        margin: 3px;
        font-size: 14px;
        max-width: none;
        flex: 1;
    }
    
    /* 統計情報をコンパクトに - 横並び2行レイアウトに変更 */
    .stats-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-template-rows: auto auto;
        gap: 5px;
        width: 100%;
    }
    
    .stat-item {
        padding: 3px 5px;
        width: 100%;
        font-size: 0.85rem;
    }
    
    /* ラベルと値を縦に並べてさらにコンパクトに */
    .stat-item p {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0;
        line-height: 1.2;
    }
    
    .stat-item .stat-label {
        font-size: 0.75rem;
        color: #666;
    }
    
    .stat-item .stat-value {
        font-size: 1.1rem;
        font-weight: bold;
    }
    
    /* 連続正解表示も横幅いっぱいに効率的に */
    #streak-container, .mode-description {
        padding: 5px 8px;
        min-height: auto;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        height: 50px;
    }
    
    .streak-container-wrapper {
        height: 50px !important;
    }
    
    #streak-count {
        font-size: 1rem;
        margin: 0 3px;
    }
    
    #streak-message {
        width: 100%;
        text-align: center;
        font-size: 0.7rem;
        margin-top: 2px;
    }
    
    #mode-description-text {
        font-size: 0.85rem;
        text-align: center;
        width: 100%;
    }
    
    /* ゲームエリアのパディングを減らす */
    .game-area {
        padding: 10px;
    }
    
    #question-container {
        margin-bottom: 15px;
    }
    
    #question-text {
        font-size: 20px;
    }
    
    /* 選択肢のサイズを調整 */
    .option img {
        width: 140px;
        height: 140px;
    }
    
    /* モバイル用のみ選択肢を2列グリッドに変更 - PCの設定を上書きするため !important を使用 */
    #options-container,
    #options-container.image-select-mode,
    #options-container.image-select-mode.four-options {
        display: grid !important;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
    }
    
    .option {
        width: 100%;
        height: auto;
    }
    
    /* 名前選択モード用 */
    .option.name-option {
        width: 100%;
        height: 120px;
    }
    
    /* 選択肢数にかかわらず、常に2列レイアウト */
    #options-container.name-select-mode {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
    }
    
    #options-container.name-select-mode.four-options {
        display: grid;
        flex-wrap: wrap;
    }
    
    .option.name-option.four-options,
    .option.name-option.three-options {
        width: 100%;
        height: 120px;
    }
    
    /* テキストサイズの調整 */
    .talent-name {
        font-size: 1.2rem;
    }
    
    .talent-kana, .talent-dormitory {
        font-size: 12px;
    }
    
    /* 連続正解表示の調整 */
    #streak-container {
        padding: 8px;
        min-height: auto;
    }
    
    #streak-message {
        font-size: 0.7em;
    }

    /* モバイル表示時の画像選択肢を完璧に中央揃えに！ */
    .image-option {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        width: 100% !important;
        margin: 0 !important;
    }
    
    .image-option img {
        margin-left: auto !important;
        margin-right: auto !important;
        max-width: 90%;
        width: auto;
        display: block;
    }
    
    #options-container .option.image-option {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 100%;
        box-sizing: border-box;
    }

    /* 選択肢が3つの場合、3つ目（最後の子要素）を中央寄せ */
    #options-container .option:nth-child(3):last-child {
        grid-column: 1 / -1; /* 行全体を使用 */
        justify-self: center; /* 水平方向の中央寄せ */
        max-width: calc(50% - 5px); /* 幅を制限して視覚的にも中央に見えるようにする */
    }

    /* タイトルのレスポンシブ対応 */
    .game-title-main {
        font-size: 1.4rem;
    }
    
    .game-title-sub {
        font-size: 1rem;
    }
    
    .game-title-inner {
        padding: 8px 15px;
    }
    
    .game-title-divider {
        margin: 0 8px;
    }
    
    .dorm-icon {
        font-size: 0.7rem;
        padding: 2px 6px;
    }
    
    .game-title-decoration {
        gap: 10px;
    }

    /* モバイル表示での余白最適化 */
    .settings-accordion {
        margin-bottom: 8px; /* 15pxから8pxに減らしてよりコンパクトに */
    }
    
    .accordion-content {
        /* padding: 8px; を削除 - アコーディオン表示の問題を解決 */
    }
    
    /* ストリークとフィードバック */
    #streak-container {
        margin-top: 8px;
        padding: 8px 10px;
        min-height: 50px;
    }
    
    #feedback {
        padding: 10px;
        margin-top: 10px;
    }
    
    /* ゲームタイトル */
    .game-title-container {
        margin: 8px auto 12px;
    }
    
    .game-title-inner {
        padding: 3px 10px;
    }
    
    /* ボタンとUIコントロール */
    button, .difficulty-btn {
        padding: 6px 10px;
        margin: 0 3px;
    }
    
    /* 統計表示 */
    .stat-item {
        padding: 4px 8px;
        margin: 3px 0;
    }
    
    /* 選択肢とゲーム要素 */
    .option, .game-container > div {
        margin-bottom: 8px;
    }

    /* タイマーの調整 */
    #timer-container {
        width: 150px;
        height: 25px;
        margin: 0 auto;
    }
    
    /* フィードバックコンテナの調整 */
    #feedback-container {
        min-height: 40px;
        margin: 15px 0;
    }

    #feedback {
        padding: 10px 15px;
        font-size: 16px;
    }
}

/* さらに小さい画面のための追加調整 */
@media (max-width: 480px) {
    /* タイトルをさらにコンパクトに */
    h1 {
        font-size: 20px;
    }
    
    /* ボタンを横に並べる - 縦並びから変更 */
    .mode-selector, .options-selector, .difficulty-selector {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        gap: 5px;
    }
    
    button {
        width: auto;
        margin: 3px;
        padding: 6px 8px;
        font-size: 13px;
        min-width: 60px;
    }
    
    /* さらに小さい画面でも歯車ボタンは適切なサイズを維持 */
    #settings-toggle {
        width: 28px; /* さらに小さく */
        height: 28px;
        padding: 0;
        font-size: 14px;
    }
    
    #settings-toggle svg {
        pointer-events: none;
        width: 14px; /* さらに小さく */
        height: 14px; /* さらに小さく */
    }
    
    /* 設定ステータスバーをさらに小さい画面向けに調整 */
    .settings-status-bar {
        padding: 3px 6px; /* さらに小さく */
        min-height: 30px; /* 最小高さをさらに小さく */
        margin-bottom: 8px;
    }
    
    .current-settings {
        font-size: 0.7rem; /* さらに小さく */
        gap: 3px;
    }
    
    .setting-item {
        font-size: 0.7rem;
        margin-right: 2px;
        padding-right: 2px;
    }
    
    /* さらに小さい画面でも歯車ボタンは適切なサイズを維持 */
    #settings-toggle, .settings-gear {
        width: 28px; /* さらに小さく */
        height: 28px;
        flex: 0 0 28px;
        min-width: 28px;
        max-width: 28px;
    }
    
    #settings-toggle svg, .settings-gear svg {
        width: 14px;
        height: 14px;
    }
    
    /* モーダル内の余白調整 */
    .modal-body {
        padding: 12px 10px;
    }
    
    .modal-header {
        padding: 8px 10px;
    }
    
    .close-button {
        width: 36px; /* 小さくするが、タッチしやすいサイズを維持 */
        height: 36px;
        flex: 0 0 36px;
        font-size: 16px;
    }
    
    /* さらに小さい画面での設定ボタン調整 */
    .modal-body .controls button {
        padding: 12px 8px; /* 上下パディングを増やしてタッチ領域を拡大 */
        font-size: 13px;
        min-width: 70px; /* 最小幅を確保 */
        flex: 1 1 auto; /* 伸縮性を調整 */
        height: 44px; /* 高さを固定してタッチしやすく */
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    /* ボタングループのレイアウトをさらに最適化 */
    .button-group {
        gap: 6px;
        margin-bottom: 10px;
    }
    
    /* 画像サイズをさらに縮小 */
    #question-image img {
        max-width: 200px;
        max-height: 200px;
    }
    
    .option img {
        width: 120px;
        height: 120px;
    }
    
    /* 選択肢の高さを調整 */
    .option.name-option {
        height: 100px;
    }
    
    /* 統計情報をさらにコンパクトに */
    .stat-item {
        padding: 2px 3px;
        font-size: 0.8rem;
    }
    
    .stat-item .stat-label {
        font-size: 0.7rem;
    }
    
    .stat-item .stat-value {
        font-size: 1rem;
    }

    /* タイトルのレスポンシブ対応 */
    .game-title-main {
        font-size: 1.2rem;
    }
    
    .game-title-sub {
        font-size: 0.9rem;
    }
    
    .game-title-inner {
        padding: 6px 12px;
    }
    
    .game-title-divider {
        margin: 0 6px;
        font-size: 0.9rem;
    }
    
    .title-sparkle {
        font-size: 10px;
    }
    
    .dorm-icon {
        font-size: 0.65rem;
        padding: 2px 5px;
    }
    
    .game-title-decoration {
        gap: 6px;
        margin-top: 8px;
    }

    /* さらに小さい画面でのタイマー調整 */
    #timer-container {
        width: 120px;
        height: 20px;
    }
    
    #timer-text {
        font-size: 0.8rem;
    }
    
    #feedback-container {
        min-height: 35px;
        margin: 10px 0;
    }
}
